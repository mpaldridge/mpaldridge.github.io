---
layout: post
title:  "Don’t write the binomial coefficient as n! / k! (n-k)!"
date:   2025-11-21
categories: maths
permalink: /blog/binomial.html
use_math: true
---

The binomial coefficient $\binom{n}{k}$, pronounced "$n$ choose $k$", is the number of ways of choosing a collection of $k$ objects from a set of $n$ objects.

To calculate the binomial coefficient, it’s best to start by thinking about picking the $k$ objects in order. There are $n$ choices for the first object, then $n-1$ choices for the second object (since you can’t pick the one you just picked again), $n-2$ for the third, and so on, down to $n-k+1$ for the final object (avoiding the $k-1$ you’ve already picked). So to pick the objects in order, there are

$$ n^{\underline{k}} = n \times (n-1) \times \cdots \times (n-k+1) $$

ways to do it. This number $n^{\underline{k}}$ is called the *falling factorial* (said “$n$ to the $k$ falling”) or *permutation number*. But we wanted the objects chosen where the order *doesn’t* matter. So we’ve over-counted. Every potential collection has been counted

$$ k! = k \times (k-1) \times \cdots \times 2 \times 1 $$

(“$k$ factorial”) times. So we have to divide through by that, to get

$$ \binom{n}{k} = \frac{n^{\underline{k}}}{k!} . $$

This is a nice formula for calculating the binomial coefficient. Let’s call it **Formula A**.

(There are other notations used for the falling factorial, such as $(n)_k$ or $P(n,k)$. I personally like $n^{\underline{k}}$, which I think is due to Donald Knuth, but I'm fine with any of the others.)

But if you look it up the binomial coefficient in books or on the web, you’re much more likely to find the formula

$$ \binom{n}{k} = \frac{n!}{k!\,(n-k)!} . $$

This formula, let’s call it **Formula B**, is also correct, in that is mathematically equal to Formula A for $k = 0, 1, \dots, n$. It's also much, much more popular than Formula A. But I think it's bad!

### 1. Difficult to understand

The first thing is that it's not so easy to interpret how Formula B corresponds to "the number of ways to choose $k$ objects from a set of $n$ objects."

For Formula A, the numerator $n^\underline{k}$ is the number of ordered ways to pick the objects and the denominator $k!$ is the number of orderings for each collection. Easy.

For Formula B, the numerator $n!$ is the number of ways of ordering the whole set. So imagine ordering the entire set then picking the first $k$ items out of that ordering. The two terms in the denominator are $k!$ and $(n-k)!$ are because we don't care about either the order within the first $k$ items (because order of our chosen items doesn't matter) or the order within the last $n-k$ items (because we're not picking them anyway). But this is weird: why are we bothering to order the whole set when we're only going to pick a few of the items?

Alternatively, Formula B-ers might argue that $n! / (n-k)!$ is just another way of writing $n^{\underline{k}}$. I suppose in a way it is: we have

$$ \frac{n!}{(n-k)!} = \frac{n \times (n-1) \times \cdots \times (n-k+1) \times (n-k) \times (n-k-1) \times \cdots \times 1}{\phantom{n \times (n-1) \times \cdots \times (n-k+1) \times {}} (n-k) \times (n-k-1) \times \cdots \times 1} , $$

which ensures the right-hand tail of the top factorial cancels. But I dislike this -- it's the sort of clever-clever writing of of an expression in terms of other things that, yes, avoids defining notation for the falling factorial, but goes out of its way to disguise what's actually going on. Reject such too-smart-by-half rewritings of easily interpretable expressions!

### 2. Doesn't work outside the range

How many ways are there of choosing 7 items from a set of 5 items? Zero! It's obviously impossible to pick 7 items out of 5, because once you've picked 5 items you've run out and have none left. What do the formulas have to say about this?

Formula A says

$$\binom{5}{7} = \frac{5^{\underline{7}}}{5!} = \frac{0}{120} = 0 ,$$

since the numerator is

$$ 5^{\underline{7}} = 5 \times 4 \times 3 \times 2 \times 1 \times 0 \times (-1) = 0 $$

due to having a 0 in it. So Formula A gives the correct answer of 0.

What about Formula B? Here we have

$$ \binom{5}{7} = \frac{5!}{7!\,(-2)!} = \frac{120}{5040 \times ???} , $$

since there's no such thing as "minus 2 factorial". So Formula B fails. (You can't get around this using the [Gamma function](https://en.wikipedia.org/wiki/Gamma_function); that's still undefined for negative integers.)


### 3. Silly with big numbers

Suppose I want to know how many ways I can choose 2 items from a set of 25. So I want to know the binomial coefficient $\binom{25}{2}$.

With Formula A, this is

$$ \binom{25}{2} = \frac{25^{\underline{2}}}{2!} = \frac{600}{2} = 300 . $$

Nice and simple – you can even do the calculation in your head.

But with Formula B, this is

$$ \binom{25}{2} = \frac{25!}{2! \times 23!} = \frac{15\,511\,210\,043\,330\,985\,984\,000\,000}{2 \times 25\,852\,016\,738\,884\,976\,640\,000} , $$

which apparently also comes out as 300 (although I certainly can’t do it in my head).

So, first: just look at it -- that is obviously very silly! More seriously, this shows that Formula B will have numerical stability problems for large numbers: when $n$ gets large, your computer will have to round the gigantic number $n!$, and this can lead to inaccuracy in calculating $\binom{n}{k}$.


### 4. Doesn't work with non-integer *n*

The binomial coefficient is also useful when "multiplying out of brackets". Here, we have

$$ (a + b)^n = \sum_{k=0}^n \binom{n}{k} a^k b^{n-k} $$

But we might also want to think about $(a + b)^x$ where $x$ is not an integer. In that case the formula

$$ (a + b)^x = \sum_{k=0}^\infty \binom{x}{k} a^k b^{x-k} $$

still holds for $\vert a\vert < \vert b\vert$, where here the binomial coefficient means the same thing as in Formula A:

$$ \binom{x}{k} = \frac{x^{\underline{k}}}{k!} = \frac{x(x-1)\cdots(x-k+1)}{k!} . $$

So, for example, with $b = 1$, $\vert a\vert < 1$, and $x = 1/2$, we have the correct formula

$$ \begin{align}
(a + 1)^{1/2} &= \binom{1/2}{0} + \binom{1/2}{1} a + \binom{1/2}{2} a^2 + \binom{1/2}{3} a^3 + \cdots \\
  &= 1 + \frac12 a - \frac{1}{8} a^2 + \frac{1}{16} a^3 + \cdots ,
\end{align} $$

where we have used Formula A to get, for example

$$ \binom{1/2}{3} = \frac{(\frac12)^{\underline{3}}}{3!} = \frac{\frac12 \times (-\frac12) \times (-\frac32) }{6} = \frac{\frac38}{6} = \frac{1}{16} , $$

working perfectly well when the top of the binomial coefficient isn't an integer.

What happens with Formula B? We get

$$ \binom{1/2}{3} = \frac{\frac12 !}{3! \, (-\frac52) !} = \frac{???}{3 \times ??} , $$

which doesn't work at all, since the factorial doesn't make sense for non-integer arguments. (Admittedly, you can usually get around this one with the Gamma function.)


### 5. Comparison with the multiset coefficient

There is also another coefficient that we often study alongside the binomial coefficient: the *multiset coefficient*. This is the number of ways of choosing $k$ items from a set of $n$ items *if you're allowed to pick each item more than once*. Think of how many different handfuls of 6 chocolates you can pick out from a tub of Celebrations: you might get 3 Bounties, 2 Mars bars and Twix, for example.

The multiset coefficient can be written using the *rising factorial*

$$ n^{\overline{k}} = n(n+1) \cdots (n+k-1) , $$

where here the terms are going up by 1 each time. Then the multiset coefficient is

$$ \bigg(\kern-0.4em\dbinom{n}{k}\kern-0.4em\bigg)  = \frac{n^{\overline{k}}}{k!} , $$

where we are using double-brackets for the multiset coefficient, compared to single-brackets for the binomial coefficient.

So writing these Formula A-style, we have a delightful symmetry between the binomial and multiset coefficients:

$$ \binom{n}{k} = \frac{n^{\underline{k}}}{k!} \qquad \bigg(\kern-0.4em\dbinom{n}{k}\kern-0.4em\bigg)  = \frac{n^{\overline{k}}}{k!} . $$

But writing them Formula B-style gives the much less pleasing to the eye

$$ \binom{n}{k} = \frac{n!}{k! \, (n-k)!} \qquad \bigg(\kern-0.4em\dbinom{n}{k}\kern-0.4em\bigg) = \frac{(n+k-1)!}{k!\,(n-1)!} . $$

Yuck.


### But what about the symmetry relation?

The Formula B-ers might have a case with the following point, though: What about the symmetry relation? The *symmetry relation* is the result

$$ \binom{n}{k} = \binom{n}{n-k}  . $$

The B-ers would argue that this expression is very obvious with their Formula, since

$$ \binom{n}{k} = \frac{n!}{k! \, (n-k)!} = \frac{n!}{(n-k)! \, k!} = \binom{n}{n-k} . $$

They would argue that this is not at all easy to see from Formula A. Is it really true that

$$ \frac{n^{\underline{k}}}{k!} = \frac{n^{\underline{n-k}}}{(n-k)!} ? $$

I sort of see the point. But I would argue that Formula B makes this *too obvious*. The symmetry relation is a deep and important fact, that deserves a proper explanation; just saying "It's trivial: Formula B says so!" denies us the opportunity to understand *why* the symmetry relation holds.

To understand why it holds, think of taking $n$ balls. How many ways we can paint $k$ of the balls red and the remaining $n-k$ blue? Well, we could either choose the $k$ red balls $\binom{n}{k}$ ways, painting the left-over balls blue, or we could choose the $n-k$ blue balls $\binom{n}{n-k}$ ways, and paint the left-over balls red. Since these count the same thing, they must be equal. This is the correct way to to understand the symmetry relation, not just finding some apparent coincidence in your formula. So, paradoxically, I think that Formula A making the symmetry relation less obvious is actually a *benefit*, not a drawback.
